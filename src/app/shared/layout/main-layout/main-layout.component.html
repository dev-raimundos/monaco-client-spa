<div class="flex h-screen w-screen overflow-hidden bg-background font-sans text-foreground">
    <aside class="flex w-64 shrink-0 flex-col border-r border-border bg-background">
        <div class="p-8 pb-4">
            <h1
                class="flex items-center gap-2 text-left text-xl font-bold leading-none tracking-tight"
            >
                <img
                    src="/companyLogo.svg"
                    alt="Logo Grupo Mônaco"
                    [class]="isDarkMode() ? 'h-[1em] w-auto' : 'h-[1em] w-auto dark:invert'"
                    class="transition-all duration-300"
                />
                <span>SisMônaco</span>
            </h1>
        </div>

        <nav class="flex-1 space-y-1 overflow-y-auto px-4 py-4 custom-scrollbar">
            @for (item of navigation(); track item.label) {
                <app-nav-item [item]="item" />
            }
        </nav>

        <div class="relative border-t border-border p-4">
            @if (isProfileMenuOpen()) {
                <div
                    class="absolute bottom-full left-4 right-4 mb-3 z-50 flex flex-col overflow-hidden rounded-xl border border-border shadow-2xl animate-in fade-in zoom-in-95 slide-in-from-bottom-6 duration-500 ease-out bg-background!"
                >
                    <div
                        class="px-4 py-3 text-[10px] font-bold uppercase tracking-widest text-muted-foreground border-b border-border bg-muted/20"
                    >
                        {{ user()?.company || 'grupo mônaco' }}
                    </div>
                    <div class="p-1.5 flex flex-col gap-0.5">
                        <button
                            (click)="setTheme('light'); toggleProfileMenu()"
                            class="theme-option flex w-full items-center gap-2 rounded-md px-3 py-2.5 text-sm transition-all duration-200"
                            [class.active]="themeMode() === 'light'"
                        >
                            <span class="material-symbols-rounded text-lg">light_mode</span>
                            <span class="font-medium">tema claro</span>
                        </button>

                        <button
                            (click)="setTheme('dark'); toggleProfileMenu()"
                            class="theme-option flex w-full items-center gap-2 rounded-md px-3 py-2.5 text-sm transition-all duration-200"
                            [class.active]="themeMode() === 'dark'"
                        >
                            <span class="material-symbols-rounded text-lg">dark_mode</span>
                            <span class="font-medium">tema escuro</span>
                        </button>

                        <div class="my-1.5 border-t border-border"></div>

                        <button
                            (click)="onLogout()"
                            class="flex w-full items-center gap-2 rounded-md px-3 py-2.5 text-sm text-destructive transition-all duration-200 hover:bg-destructive/10"
                        >
                            <span class="material-symbols-rounded text-lg">logout</span>
                            <span class="font-bold uppercase tracking-tight">sair</span>
                        </button>
                    </div>
                </div>

                <div
                    class="fixed inset-0 z-40 bg-black/20 backdrop-blur-[2px]"
                    (click)="toggleProfileMenu()"
                ></div>
            }
            <button
                (click)="toggleProfileMenu()"
                class="relative z-50 flex min-h-14 w-full items-center gap-2 rounded-xl px-2 text-left hover:bg-muted/80 focus:outline-none group"
                [class.bg-muted]="isProfileMenuOpen()"
            >
                <div
                    class="flex h-8 w-8 shrink-0 items-center justify-center rounded-full bg-foreground text-background font-medium text-[10px] uppercase shadow-sm transition-transform duration-300 group-hover:scale-105"
                >
                    {{ userInitials() }}
                </div>

                <div class="flex min-w-0 flex-1 flex-col justify-center overflow-hidden">
                    <span
                        class="truncate text-sm font-medium leading-tight text-foreground group-hover:text-primary"
                    >
                        {{ displayName() }}
                    </span>
                    <span
                        class="truncate text-[9px] text-muted-foreground uppercase font-medium tracking-tight"
                    >
                        {{ user()?.occupation || 'cargo não definido' }}
                    </span>
                </div>

                <span
                    class="material-symbols-rounded text-muted-foreground/30 text-base transition-all duration-500 group-hover:text-primary/60 shrink-0"
                    [class.rotate-180]="isProfileMenuOpen()"
                >
                    keyboard_arrow_up
                </span>
            </button>
        </div>
    </aside>

    <main class="h-full flex-1 overflow-y-auto bg-background/50">
        <router-outlet></router-outlet>
    </main>
</div>
