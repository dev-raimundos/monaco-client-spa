<div class="flex h-screen bg-background text-foreground font-sans">
    <aside class="w-64 bg-background border-r border-border flex flex-col shrink-0">
        <div class="p-8 pb-4">
            <h1 class="text-xl font-bold text-left leading-none flex items-center">
                SisMônaco
                <span class="badge-v3-dynamic">V3</span>
            </h1>
        </div>

        <nav class="flex-1 px-4 py-4 space-y-1 overflow-y-auto">
            @for (item of navItems; track item.label) {
            @if (!item.children) {
            <a [routerLink]="item.route" routerLinkActive="bg-foreground/5 font-medium border-l-2 border-primary"
                class="flex items-center px-4 py-2 text-sm lowercase text-muted-foreground hover:text-foreground hover:bg-muted/30 transition-all rounded-r-md group">
                <span class="material-symbols-rounded mr-3 opacity-60">dashboard</span>
                {{ item.label }}
            </a>
            } @else {
            <div class="flex flex-col">
                <button (click)="toggleMenu(item.label)"
                    class="w-full flex items-center justify-between px-4 py-2 text-sm lowercase text-muted-foreground hover:text-foreground hover:bg-muted/30 transition-all rounded-md">
                    <div class="flex items-center">
                        <span class="material-symbols-rounded mr-3 opacity-60">group</span>
                        {{ item.label }}
                    </div>
                    <span class="material-symbols-rounded text-lg transition-transform duration-300"
                        [class.rotate-180]="expandedMenu() === item.label">
                        expand_more
                    </span>
                </button>

                @if (expandedMenu() === item.label) {
                <div class="ml-9 mt-1 space-y-1 border-l border-border/40">
                    @for (child of item.children; track child.label) {
                    <a [routerLink]="child.route" routerLinkActive="text-foreground font-medium"
                        class="block py-2 px-6 text-xs lowercase text-muted-foreground hover:text-foreground transition-colors">
                        {{ child.label }}
                    </a>
                    }
                </div>
                }
            </div>
            }
            }
        </nav>

        <div class="p-4 border-t border-border">
            <button (click)="menu.toggle($event)"
                class="w-full h-12 flex items-center gap-3 px-3 py-3 rounded-lg hover:bg-muted/20 transition-all text-left">
                <div
                    class="w-8 h-8 rounded-full bg-foreground text-background flex items-center justify-center font-medium text-xs uppercase">
                    {{ userInitials() }}
                </div>
                <div class="flex flex-col overflow-hidden flex-1">
                    <span class="text-sm font-medium truncate leading-tight">
                        {{ displayName() }}
                    </span>
                    <span class="text-[11px] text-muted-foreground opacity-80 uppercase">
                        {{ user()?.occupation || 'cargo não definido' }}
                    </span>
                </div>
            </button>
            <p-menu #menu [model]="profileMenuItems()" [popup]="true" appendTo="body" />
        </div>
    </aside>

    <main class="flex-1 overflow-auto bg-background/50">
        <router-outlet></router-outlet>
    </main>
</div>
